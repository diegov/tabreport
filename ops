{"author":{"id":"d8a5b529a831fe2ec3072b9f42af5df35676335e5b3f40d4c21a731599abdf53"},"ops":[{"type":1,"timestamp":1737936021,"nonce":"eutFBu+S7jhRGx0Z1f6/pr2udUo=","title":"Integration test failures cause by Firefox crash shortly after startup.","message":"Marionette crashes with this:\n\n```\nTraceback (most recent call last):\n  File \"/home/d/code/projects/tabreport/integration_tests/tabreport_tests.py\", line 38, in setUpClass\n    cls.client = get_marionette(FF_VERSION, EXTENSION_PATH)\n  File \"/home/d/code/projects/tabreport/integration_tests/firefox.py\", line 119, in get_marionette\n    client = Marionette(host=\"localhost\", port=12828, bin=ff_path, headless=False)\n  File \"/home/d/code/projects/tabreport/integration_tests/venv/lib/python3.10/site-packages/marionette_driver/marionette.py\", line 546, in __init__\n    self.start_binary(self.startup_timeout)\n  File \"/home/d/code/projects/tabreport/integration_tests/venv/lib/python3.10/site-packages/marionette_driver/marionette.py\", line 577, in start_binary\n    reraise(IOError, IOError(msg.format(timeout)), sys.exc_info()[2])\n  File \"/home/d/code/projects/tabreport/integration_tests/venv/lib/python3.10/site-packages/six.py\", line 718, in reraise\n    raise value.with_traceback(tb)\n  File \"/home/d/code/projects/tabreport/integration_tests/venv/lib/python3.10/site-packages/marionette_driver/marionette.py\", line 567, in start_binary\n    self.raise_for_port(timeout=timeout)\n  File \"/home/d/code/projects/tabreport/integration_tests/venv/lib/python3.10/site-packages/marionette_driver/marionette.py\", line 661, in raise_for_port\n    raise socket.timeout(\nOSError: Process killed after 120s because no connection to Marionette server could be established. Check gecko.log for errors\n\n```\n\nThe reason is that the Firefox instance is crashing with this message:\n\n```\nmozversion INFO | application_buildid: 20240223091706\nmozversion INFO | application_changeset: 1ec7aaea5f3d1777524a7330e076d096399ae4f5\nmozversion INFO | application_display_name: Firefox Developer Edition\nmozversion INFO | application_id: {ec8030f7-c20a-464f-9b0e-13a3a9e97384}\nmozversion INFO | application_name: Firefox\nmozversion INFO | application_remotingname: firefox-aurora\nmozversion INFO | application_repository: https://hg.mozilla.org/releases/mozilla-beta\nmozversion INFO | application_vendor: Mozilla\nmozversion INFO | application_version: 124.0\nmozversion INFO | platform_buildid: 20240223091706\nmozversion INFO | platform_changeset: 1ec7aaea5f3d1777524a7330e076d096399ae4f5\nmozversion INFO | platform_repository: https://hg.mozilla.org/releases/mozilla-beta\nmozversion INFO | platform_version: 124.0\nconsole.warn: services.settings: Ignoring preference override of remote settings server\nconsole.warn: services.settings: Allow by setting MOZ_REMOTE_SETTINGS_DEVTOOLS=1 in the environment\n1737935601992   Marionette      INFO    Marionette enabled\n1737935602063   Marionette      INFO    Listening on port 12828\n[Parent 311231, IPC I/O Parent] WARNING: process 311395 exited on signal 11: file /builds/worker/checkouts/gecko/ipc/chromium/src/base/process_util_posix.cc:265\n[Parent 311231, IPC I/O Parent] WARNING: process 311403 exited on signal 11: file /builds/worker/checkouts/gecko/ipc/chromium/src/base/process_util_posix.cc:265\nJavaScript error: resource://gre/modules/CaptiveDetect.sys.mjs, line 287: NS_ERROR_FAILURE: No canonical URL set up.\nconsole.error: ({})\nA content process crashed and MOZ_CRASHREPORTER_SHUTDOWN is set, shutting down\nJavaScript error: resource://activity-stream/lib/ActivityStreamPrefs.sys.mjs, line 34: NS_ERROR_ILLEGAL_VALUE: Component returned failure code: 0x80070057 (NS_ERROR_ILLEGAL_VALUE) [nsIPrefBranch.removeObserver]\nA content process crashed and MOZ_CRASHREPORTER_SHUTDOWN is set, shutting down\n1737935603040   Marionette      INFO    Stopped listening on port 12828\n```\n\nIt's failing with versions of firefox that were working before, which is odd. It happens both in the Github action, as well as locally.","files":null}]}